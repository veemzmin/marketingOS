---
phase: 02-governance-engine
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/lib/governance/types.ts
  - src/lib/governance/policies/stigma-language.ts
  - src/lib/governance/policies/medical-claims.ts
  - src/lib/governance/policies/dsm5-terminology.ts
  - src/lib/governance/policies/treatment-qualification.ts
  - src/lib/governance/policies/suicide-safety.ts
  - src/lib/governance/policies/consent-requirements.ts
autonomous: true

must_haves:
  truths:
    - "System has defined 50-100 stigmatizing mental health terms"
    - "System has defined unsupported medical claim patterns"
    - "System has defined DSM-5 terminology reference list"
    - "System has defined crisis resource requirements for suicide safety"
    - "System has defined consent requirements for patient testimonials"
  artifacts:
    - path: "src/lib/governance/types.ts"
      provides: "Shared TypeScript types for violations and validation results"
      exports: ["Violation", "ValidationResult", "PolicySeverity"]
      min_lines: 30
    - path: "src/lib/governance/policies/stigma-language.ts"
      provides: "Curated list of 50-100 stigmatizing terms"
      exports: ["STIGMA_TERMS"]
      contains: "addict|junkie|psycho|schizo|crazy"
    - path: "src/lib/governance/policies/medical-claims.ts"
      provides: "Unsupported medical claims patterns"
      exports: ["UNSUPPORTED_CLAIMS"]
      contains: "cure|guaranteed"
    - path: "src/lib/governance/policies/dsm5-terminology.ts"
      provides: "DSM-5 reference terminology list"
      exports: ["DSM5_TERMS"]
      min_lines: 20
    - path: "src/lib/governance/policies/suicide-safety.ts"
      provides: "Required crisis resources"
      exports: ["REQUIRED_RESOURCES", "hasRequiredCrisisResources"]
      contains: "988"
    - path: "src/lib/governance/policies/consent-requirements.ts"
      provides: "Patient testimonial consent patterns"
      exports: ["CONSENT_PATTERNS"]
      min_lines: 10
  key_links:
    - from: "src/lib/governance/policies/*.ts"
      to: "src/lib/governance/types.ts"
      via: "import type { Violation }"
      pattern: "import.*Violation.*from.*types"
---

<objective>
Establish the foundational policy definitions and type system for the Governance Engine. This plan creates the curated healthcare compliance rules (stigma terms, medical claims, DSM-5 codes, crisis resources, consent requirements) and shared TypeScript interfaces that all validators will use.

Purpose: Provide the "source of truth" policy data that validators will enforce. By separating policy definitions from validation logic, we enable audit trails, policy updates without code changes, and compliance documentation.

Output: 6 policy definition files + shared type system ready for validator implementation.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-governance-engine/02-CONTEXT.md
@.planning/phases/02-governance-engine/02-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create shared governance types</name>
  <files>src/lib/governance/types.ts</files>
  <action>
Create TypeScript type definitions for governance validation system:

```typescript
export type PolicySeverity = 'high' | 'medium' | 'low'

export interface Violation {
  policyId: string
  severity: PolicySeverity
  text: string              // Problematic content snippet (±20 chars context)
  explanation: string       // Why it violates + suggested alternative
  startIndex: number        // Position in content for Phase 3 highlighting
  endIndex: number
}

export type ValidationResult =
  | { status: 'pass' }
  | { status: 'violations'; violations: Violation[] }

export interface ComplianceScore {
  score: number           // 0-100
  reasoning: string[]     // Breakdown of what affected score
  passed: string[]        // Policy IDs that passed
  violations: Violation[] // All violations found
}
```

Use discriminated union pattern for ValidationResult (enables type narrowing in validators). Export all types for use across governance module.
  </action>
  <verify>
```bash
npx tsc --noEmit --project tsconfig.json
```
No type errors. File exports Violation, ValidationResult, PolicySeverity, ComplianceScore types.
  </verify>
  <done>TypeScript types defined and validated. Validators can import these interfaces.</done>
</task>

<task type="auto">
  <name>Task 2: Define stigma language policy</name>
  <files>src/lib/governance/policies/stigma-language.ts</files>
  <action>
Create curated list of 50-100 stigmatizing mental health terms based on research recommendations:

**Include these categories:**
- Substance use stigma: addict, junkie, dopehead, doper, druggie, alcoholic, drunk
- Mental health stigma: psycho, schizo, crazy, insane, nuts, mental, deranged, demented, lunatic
- Intellectual disability stigma: retarded, idiot, stupid, dumb, moron, imbecile
- Trauma/PTSD stigma: damaged, broken, victim (context-dependent, see research note)
- Personality disorder stigma: borderline (when used pejoratively), narcissist (casual use)
- Depression/suicide stigma: committed suicide (use "died by suicide"), attention-seeking
- General: disturbed, troubled, suffering from (use "living with"), afflicted

**Use word-boundary safe format:**
```typescript
export const STIGMA_TERMS = [
  // Substance use stigma
  'addict',
  'junkie',
  'dopehead',
  // ... (continue for all 50-100 terms)
] as const

// Document alternatives in comments for each category
// Example: "addict" → "person with substance use disorder"
```

Reference research guidance: Avoid broad terms like "victim" without context rules (causes false positives). Focus on clearly stigmatizing language.
  </action>
  <verify>
```bash
# Check file exports array
node -e "const {STIGMA_TERMS} = require('./src/lib/governance/policies/stigma-language.ts'); console.log(STIGMA_TERMS.length)"
```
Output shows 50+ terms.
  </verify>
  <done>Stigma language list created with 50-100 curated terms and documented alternatives.</done>
</task>

<task type="auto">
  <name>Task 3: Define medical claims, DSM-5, and safety policies</name>
  <files>
    src/lib/governance/policies/medical-claims.ts
    src/lib/governance/policies/dsm5-terminology.ts
    src/lib/governance/policies/treatment-qualification.ts
    src/lib/governance/policies/suicide-safety.ts
    src/lib/governance/policies/consent-requirements.ts
  </files>
  <action>
Create remaining 5 policy definition files:

**medical-claims.ts:**
```typescript
export const UNSUPPORTED_CLAIMS = [
  { term: 'cure', context: 'mental health', alternative: 'effective treatment for' },
  { term: 'guaranteed', context: 'treatment outcome', alternative: 'may help' },
  { term: 'proven to eliminate', context: 'symptoms', alternative: 'shown to reduce' },
  { term: 'fixes', context: 'mental health', alternative: 'supports improvement in' },
] as const
```

**dsm5-terminology.ts:**
```typescript
// Hardcoded reference list of 20-30 common diagnoses for MVP
export const DSM5_TERMS = [
  'major depressive disorder',
  'generalized anxiety disorder',
  'panic disorder',
  'post-traumatic stress disorder',
  'social anxiety disorder',
  'obsessive-compulsive disorder',
  'bipolar disorder',
  'persistent depressive disorder',
  'adjustment disorder',
  'acute stress disorder',
  // ... continue to 20-30 terms
  // Note: Phase 3 will integrate official DSM-5-TR API if licensing allows
] as const
```

**treatment-qualification.ts:**
```typescript
export const UNQUALIFIED_LANGUAGE = [
  { term: 'will cure', qualified: 'may help manage' },
  { term: 'eliminates symptoms', qualified: 'can reduce symptoms' },
  { term: 'prevents relapse', qualified: 'may help prevent relapse' },
] as const
```

**suicide-safety.ts:**
```typescript
export const REQUIRED_RESOURCES = [
  {
    name: '988 Suicide and Crisis Lifeline',
    phone: '988',
    text: 'Text 988',
    website: 'https://988lifeline.org/',
  },
  {
    name: 'Crisis Text Line',
    text: 'Text HOME to 741741',
    website: 'https://www.crisistextline.org/',
  },
] as const

export const SUICIDE_KEYWORDS = ['suicide', 'suicidal', 'kill myself', 'end my life', 'self-harm'] as const

export function hasRequiredCrisisResources(content: string): boolean {
  return REQUIRED_RESOURCES.some(
    resource =>
      content.includes(resource.phone || '') ||
      content.includes(resource.text) ||
      content.includes(resource.name)
  )
}
```

**consent-requirements.ts:**
```typescript
export const TESTIMONIAL_INDICATORS = [
  'patient story',
  'client testimonial',
  'success story',
  'patient experience',
  'real story',
] as const

export const CONSENT_PATTERNS = [
  'written consent',
  'authorized',
  'permission obtained',
  'consent on file',
] as const
```

Follow research pattern: Store rules as declarative configuration separate from validation logic. Use `as const` for type safety. Document sources in comments (988lifeline.org, CMS standards, etc.).
  </action>
  <verify>
```bash
npx tsc --noEmit --project tsconfig.json
```
No errors. All policy files export expected constants.
  </verify>
  <done>All 5 policy definition files created with healthcare-compliant rules and documented sources.</done>
</task>

</tasks>

<verification>
1. Run `npx tsc --noEmit` - no type errors across governance module
2. Check all policy files export expected constants (STIGMA_TERMS has 50+ items, DSM5_TERMS has 20-30 items)
3. Verify hasRequiredCrisisResources function exists in suicide-safety.ts
4. Confirm all policy files import types from src/lib/governance/types.ts
</verification>

<success_criteria>
- [ ] 7 files created in src/lib/governance (1 types, 6 policies)
- [ ] STIGMA_TERMS contains 50-100 curated mental health stigma terms
- [ ] All policy files use `as const` for type safety
- [ ] Shared types (Violation, ValidationResult, ComplianceScore) exported from types.ts
- [ ] TypeScript compilation passes with no errors
- [ ] Policy definitions are declarative (data, not logic) as per research pattern
</success_criteria>

<output>
After completion, create `.planning/phases/02-governance-engine/02-01-SUMMARY.md` using the summary template.
</output>
